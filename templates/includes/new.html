{{ define "title"}}
<title>发表内容</title>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery.sumoselect/3.1.6/sumoselect.min.css"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.sumoselect/3.1.6/jquery.sumoselect.min.js"></script>
{{ end }}

{{define "content"}}
<form action="/p/new" method="post">
    <div class="mt-2 flex flex-col gap2 text-sm">

        <div class="flex flex-row gap-2 mt-2">
            <div class="font-bold">类型</div>
            <div class="flex flex-row gap-2 items-center">
                <input type="radio" id="link" name="type" value="link" checked/>
                <label for="link">链接</label>
                <input type="radio" id="ask" name="type" value="ask"/>
                <label for="ask">提问</label>
            </div>
        </div>
        <div class="flex flex-row gap-2 items-center">
            <label for="title" class="font-bold">标题</label>
            <input type="text" id="title" name="title" class="input flex-1"/>
        </div>



        <div class="flex flex-row gap-2 items-center">
            <label for="tag" class="font-bold">标签</label>
            <select id="tag" multiple class="selectBox  input flex-1" name="tagIDs[]">

                {{range $i, $e := .tags}}
                {{if not $e.ParentID}}
                {{if gt $i 0}}</optgroup>{{end}}
                <optgroup label="{{$e.Name}}">
                    {{else}}
                    <option value="{{$e.ID}}">{{$e.Name}}</option>
                    {{end}}
                    {{end}}

            </select>
        </div>
        <div class="flex flex-row gap-2 items-center"  id="linkEle">
            <label for="linkUrl" class="font-bold">链接</label>
            <input type="text" id="linkUrl" name="link" class="input flex-1"/>
        </div>
        <div class="flex flex-row gap-2 items-center " id="content">
            <label for="title" class="font-bold">内容</label>
            <textarea
                    name="content"
                    id=""
                    cols="30"
                    rows="10"
                    class="input flex-1"
            ></textarea>
        </div>

        <div class="flex flex-row gap-2 items-center mt-2">
            <button class="btn py-2 px-4" id="submitNewPost" type="submit">提交</button>
            <button class="cursor-pointer bg-white border-0 text-black rounded py-2 px-4">清空</button>
        </div>

        <div>{{.msg}}</div>

    </div>
</form>
<style>
    .SumoSelect {
        flex: 1;
    }
</style>
<script>
    $(document).ready(function () {
        $('.selectBox').SumoSelect({
            placeholder: '请最少选择一个标签,最多选择5个',
            search: true,
            searchText: '支持搜索',
            csvDispCount: 5
        });

        // $("#submitNewPost").click(()=>{
        //     console.log($("#tag").val())
        // })

        $("#content").hide()

        $("input[type=radio]").click((e) => {
            const the = $(e.target)
            console.log(the, the.val())
            if (the.val() === 'ask') {
                $("#content").show()
                $("#linkEle").hide()
            } else if (the.val() === 'link') {
                $("#content").hide()
                $("#linkEle").show()
            }
        })
    });
</script>
{{end}}